# 内存碎片
1. 碎片合并工具：比如处理文件系统碎片，因为文件系统可以自由移动，经过分析，重新排序已分配存储块。
2. 反碎片：  
    1. 前提：内核将已分配页划分为3种不同类型：   
        1. 不可移动页：在内存中有固定位置，不能移动到其他地方。核心内核分配的大多数内存属于该类别
        2. 可回收页：不能直接移动，但是可以删除，其内容可以从某些源重新生成。例如映射自文件的数据。
        3. 可移动页：可以随意移动，属于用户空间应用程序的页属于该类型。他们是通过页表映射的，如果数据复制到新位置，只需要改变页表的指向，应用程序不会感知到。
    2. 工作原理：根据页的可移动性，将其分组，从而可以减少内存碎片。

伙伴系统数据结构：
```
# 将空闲列表分解为MIGRATE_TYPE个列表
<mmzone.h>
struct free_area {
    struct list_head free_list[MIGRATE_TYPES];
    unsigned long nr_free;
}
```
如果内核无法满足针对某一给定迁移类型的分配请求，则通过提供的备用列表，规定了在指定列表中无法满足分配请求时，接下来应使用哪一种迁移类型。例如：UNMOVABLE不可用时，依次尝试使用 RECYCLABLE，MOVABLE，RESERVE
